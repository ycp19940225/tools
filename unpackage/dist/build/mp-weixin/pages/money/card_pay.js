(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/money/card_pay"],{"179a":function(t,n,a){"use strict";var e={"uni-number-box":()=>a.e("components/uni-number-box/uni-number-box").then(a.bind(null,"a7f4"))},o=function(){var t=this,n=t.$createElement;t._self._c},i=[];a.d(n,"b",function(){return o}),a.d(n,"c",function(){return i}),a.d(n,"a",function(){return e})},"22a2":function(t,n,a){"use strict";var e=a("a65c"),o=a.n(e);o.a},"2b5b":function(t,n,a){"use strict";a.r(n);var e=a("f8a4"),o=a.n(e);for(var i in e)"default"!==i&&function(t){a.d(n,t,function(){return e[t]})}(i);n["default"]=o.a},a65c:function(t,n,a){},a70d:function(t,n,a){"use strict";(function(t){a("4520"),a("921b");e(a("66fd"));var n=e(a("d5b4"));function e(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,a("543d")["createPage"])},d5b4:function(t,n,a){"use strict";a.r(n);var e=a("179a"),o=a("2b5b");for(var i in o)"default"!==i&&function(t){a.d(n,t,function(){return o[t]})}(i);a("22a2");var c,u=a("f0c5"),r=Object(u["a"])(o["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],c);n["default"]=r.exports},f8a4:function(t,n,a){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=function(){return a.e("components/uni-number-box/uni-number-box").then(a.bind(null,"a7f4"))},o={components:{uniNumberBox:e},data:function(){return{payType:1,cardList:[],card_id:0,totalFee:0,choose_number:1}},computed:{},onLoad:function(t){var n=this;n.getPageData(t)},methods:{chooseNumber:function(t){this.choose_number=t,this.calculateTotol()},getCardId:function(t){var n=this;n.card_id=t,n.calculateTotol()},calculateTotol:function(){var t=this.card_id,n=this.cardList[t];this.cardList.length>0&&(this.totalFee=(1*n.price*this.choose_number).toFixed(2))},checkPay:function(n){var a=this,e={id:n};this.$http.post("/api/card/checkPay",e).then(function(n){if(console.log(n),1!=n.data.code)t.showToast({title:n.data.info,icon:"none"});else{var e=n.data.data;1==e.paySuccess&&(clearInterval(a.timeId),t.showToast({title:"充值成功！",icon:"success"}),setTimeout(function(){t.navigateTo({url:"/pages/coupons/get"})},1e3))}}).catch(function(t){console.log(t)})},getPageData:function(n){var a=this,e=this;t.showLoading({title:"加载中..."}),this.$http.post("/api/card/getCardList",n).then(function(n){if(console.log(n),1!=n.data.code)t.showToast({title:n.data.info,icon:"none"});else{var o=n.data.data;e.cardList=o,a.calculateTotol(),t.hideLoading()}}).catch(function(t){console.log(t)}),t.hideLoading()},changePayType:function(t){this.payType=t},confirm:function(){var n=this;if(1!=n.payType)return t.showToast({title:"暂不支持该种支付方式！",icon:"none"}),!1;var a=n.cardList[n.card_id];if(0==n.cardList.length)return t.showToast({title:"暂无可选择储值卡！",icon:"none"}),!1;var e={card_id:a.id,number:n.choose_number};this.$http.post("/api/card/doPay",e).then(function(a){if(1!=a.data.code&&19!=a.data.code)t.showToast({title:a.data.info,icon:"none"});else{var e=a.data.data;t.requestPayment({provider:"wxpay",timeStamp:e.timeStamp,nonceStr:e.nonceStr,package:e.package,signType:e.signType,paySign:e.paySign,success:function(t){n.timeId=setInterval(function(){n.checkPay(e.orderId)},500)},fail:function(t){console.log("fail:"+JSON.stringify(t))}})}}).catch(function(t){console.log(t)})}}};n.default=o}).call(this,a("543d")["default"])}},[["a70d","common/runtime","common/vendor"]]]);