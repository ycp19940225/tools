(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/commit/index"],{"00b7":function(e,t,i){},2873:function(e,t,i){"use strict";(function(e){function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=function(){return i.e("components/uni-popup/uni-popup").then(i.bind(null,"1240"))},n={components:{uniPopup:c},data:function(){return{addressData:{},product_id:"",isClicked:!1,remark:"",total_price:0,pickerDetail:[],pickerPackageRes:{index:0},pickerGroupRes:{index:0},product:{},hide:!0,productData:[{name:"VITARGO唯它高 能量胶 国家队专用 德国原产----",item_open:!1,item:[{item_name:"颜色",item_value:{21:"紫/玫红",32:"黑/绿"}},{item_name:"尺码",item_value:{1:"S（35-38）",3:"M（39-42）",7:"L（43-46）"}}]},{name:"VITARGO唯它高 能量胶 国家队专用 德国原产----",item_open:!1,item:[{item_name:"颜色",item_value:{21:"紫/玫红",32:"黑/绿"}},{item_name:"尺码",item_value:{1:"S（35-38）",3:"M（39-42）",7:"L（43-46）"}}]}],picker:["套餐一","套餐二","套餐三"],basicsList:[{cuIcon:"cuIcon-radioboxfill",name:"报名组合"},{cuIcon:"cuIcon-title",name:"支付订单"},{cuIcon:"cuIcon-title",name:"完善资料"},{cuIcon:"cuIcon-title",name:"报名成功"}],basics:0,numList:[{name:"开始"},{name:"等待"},{name:"错误"},{name:"完成"}],num:0,scroll:0}},mounted:function(){},onLoad:function(e){console.log(e);var t=this;this.product_id=e.product_id,t.getPageData(e)},onShow:function(){console.log("App Show22"),this.calculatePrice()},methods:{bindTextAreaBlur:function(e){this.remark=e.detail.value},commit:function(t){var i=this;e.requestSubscribeMessage({tmplIds:["-ib8s8PRjp81McgQ6WJ0EGtHJn-nJ7lZuByZZv9nI-A"],success:function(e){i.doCommit()},fail:function(e){console.log(e),i.doCommit()}})},doCommit:function(){for(var t,i=this,c=i.product.package[i.pickerPackageRes.index],n=i.product.group[i.pickerGroupRes.index],a=[],r=this.product.goods,u=0,s=r.length;u<s;++u){var d=r[u];1!=d.check&&1!=d.item_open||void 0==d.price||(t=o({},d.id,d.checked_attr),a.push(t))}var p={activity_id:i.product.id,group_id:n.id,total_price:i.total_price,remark:i.remark,goods_info:a,member_address_id:i.addressData.id};if(void 0!=c&&i.product.package.length>0&&(p.package_id=c.id),1==i.isClicked)return e.showToast({title:"请不要重复提交！",icon:"none"}),!1;i.isClicked=!0,i.$http.post("/api/order/createOrder",p).then(function(t){if(console.log(t),1!=t.data.code)e.showToast({title:t.data.info,icon:"none"});else{var i=t.data.data;e.showToast({title:t.data.info,icon:"success"}),setTimeout(function(){e.redirectTo({url:"/pages/money/pay?orderId="+i})},2e3)}}).catch(function(e){console.log(e)})},pickerPackage:function(e){var t=e.target.value;this.pickerPackageRes.index=t,this.calculatePrice()},pickerGroup:function(e){var t=e.target.value;this.pickerGroupRes.index=t,this.calculatePrice()},getPageData:function(t){var i=this;e.showLoading({title:"加载中...",mask:!0}),this.$http.post("/api/order/confirm",t).then(function(t){if(console.log(t),1!=t.data.code)e.showToast({title:t.data.info,icon:"none"});else{var o=t.data.data;i.product=o,i.addressData=o.addressData,i.calculatePrice(),e.hideLoading()}}).catch(function(e){console.log(e)}),e.hideLoading()},openDetail:function(){var e,t,i,o=this;e=o.product.package[o.pickerPackageRes.index],t=o.product.group[o.pickerGroupRes.index],o.pickerDetail=[],void 0!=o.product.package&&o.product.package.length>0&&o.pickerDetail.push(e);for(var c=this.product.goods,n=0,a=c.length;n<a;++n){var r=c[n];1!=r.check&&1!=r.item_open||void 0==r.price||(i={name:r.title,price:r.price},o.pickerDetail.push(i))}o.pickerDetail.push(t),o.calculatePrice(),this.$refs.detail.open(),this.hide=!1},calculatePrice:function(){var e,t,i=this;void 0!=i.product.package&&i.product.package.length>0?(e=i.product.package[i.pickerPackageRes.index],t=i.product.group[i.pickerGroupRes.index],i.total_price=(1*e.price+1*t.price).toFixed(2)):(t=i.product.group[i.pickerGroupRes.index],i.total_price=(1*t.price).toFixed(2));var o=this.product.goods,c=0;if(void 0!=o&&o.length>0){for(var n=0,a=o.length;n<a;++n){var r=o[n];1!=r.check&&1!=r.item_open||void 0==r.price||(c+=1*r.price)}if(c>0){var u=1*i.total_price+1*c;i.total_price=u.toFixed(2)}}},openItem:function(e){var t=this.productData[e].open;this.$set(this.productData[e],"open",1!=t),console.log(this.productData[e],e)},tabSelect:function(){console.log(1)},openPopup:function(){e.navigateTo({url:"/pages/commit/goods_attr?product_id="+this.product_id})},closePopup:function(){this.hide=!0,this.$refs.detail.close()},BasicsSteps:function(){this.basics=this.basics==this.basicsList.length-1?0:this.basics+1},NumSteps:function(){this.num=this.num==this.numList.length-1?0:this.num+1},ScrollSteps:function(){this.scroll=9==this.scroll?0:this.scroll+1},picker_goods:function(){console.log(1)}}};t.default=n}).call(this,i("543d")["default"])},"596b":function(e,t,i){"use strict";var o=i("00b7"),c=i.n(o);c.a},"9fb2":function(e,t,i){"use strict";i.r(t);var o=i("dcab"),c=i("cd8f");for(var n in c)"default"!==n&&function(e){i.d(t,e,function(){return c[e]})}(n);i("596b");var a,r=i("f0c5"),u=Object(r["a"])(c["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],a);t["default"]=u.exports},cd8f:function(e,t,i){"use strict";i.r(t);var o=i("2873"),c=i.n(o);for(var n in o)"default"!==n&&function(e){i.d(t,e,function(){return o[e]})}(n);t["default"]=c.a},dcab:function(e,t,i){"use strict";var o={"uni-popup":()=>i.e("components/uni-popup/uni-popup").then(i.bind(null,"1240"))},c=function(){var e=this,t=e.$createElement;e._self._c},n=[];i.d(t,"b",function(){return c}),i.d(t,"c",function(){return n}),i.d(t,"a",function(){return o})},fd29:function(e,t,i){"use strict";(function(e){i("4520"),i("921b");o(i("66fd"));var t=o(i("9fb2"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i("543d")["createPage"])}},[["fd29","common/runtime","common/vendor"]]]);